<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pong Touch</title>
<style>
    body {
        margin: 0;
        background: black;
        overflow: hidden;
        touch-action: none;
    }
    canvas {
        display: block;
        margin: auto;
        background: #000;
    }
    #marcador {
        position: absolute;
        top: 10px;
        left: 50%;
        transform: translateX(-50%);
        color: white;
        font-size: 24px;
        font-family: Arial, sans-serif;
    }
    #gameover {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: yellow;
        font-size: 30px;
        font-family: Arial, sans-serif;
        display: none;
    }
</style>
</head>
<body>
<div id="marcador">0 - 0</div>
<div id="gameover"></div>
<canvas id="pong"></canvas>

<script>
const canvas = document.getElementById("pong");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let paddleHeight = 100;
let paddleWidth = 15;
let leftPaddleY = (canvas.height - paddleHeight) / 2;
let rightPaddleY = (canvas.height - paddleHeight) / 2;
let ballSize = 15;
let ballX = canvas.width / 2;
let ballY = canvas.height / 2;
let ballSpeedX = 5;
let ballSpeedY = 5;

let scoreLeft = 0;
let scoreRight = 0;
const maxScore = 5;

function drawRect(x, y, w, h, color) {
    ctx.fillStyle = color;
    ctx.fillRect(x, y, w, h);
}

function drawCircle(x, y, r, color) {
    ctx.fillStyle = color;
    ctx.beginPath();
    ctx.arc(x, y, r, 0, Math.PI * 2);
    ctx.closePath();
    ctx.fill();
}

function draw() {
    drawRect(0, 0, canvas.width, canvas.height, "black");
    drawRect(10, leftPaddleY, paddleWidth, paddleHeight, "white");
    drawRect(canvas.width - paddleWidth - 10, rightPaddleY, paddleWidth, paddleHeight, "white");
    drawCircle(ballX, ballY, ballSize, "white");
}

function moveBall() {
    ballX += ballSpeedX;
    ballY += ballSpeedY;

    // Rebote arriba y abajo
    if (ballY - ballSize < 0 || ballY + ballSize > canvas.height) {
        ballSpeedY = -ballSpeedY;
    }

    // Colisión con la pala izquierda
    if (ballX - ballSize < 25 && ballY > leftPaddleY && ballY < leftPaddleY + paddleHeight) {
        ballSpeedX = -ballSpeedX;
    }

    // Colisión con la pala derecha
    if (ballX + ballSize > canvas.width - 25 && ballY > rightPaddleY && ballY < rightPaddleY + paddleHeight) {
        ballSpeedX = -ballSpeedX;
    }

    // Punto para derecha
    if (ballX - ballSize < 0) {
        scoreRight++;
        resetBall();
    }

    // Punto para izquierda
    if (ballX + ballSize > canvas.width) {
        scoreLeft++;
        resetBall();
    }

    document.getElementById("marcador").textContent = `${scoreLeft} - ${scoreRight}`;

    if (scoreLeft >= maxScore || scoreRight >= maxScore) {
        endGame();
    }
}

function resetBall() {
    ballX = canvas.width / 2;
    ballY = canvas.height / 2;
    ballSpeedX = -ballSpeedX;
    ballSpeedY = 5 * (Math.random() > 0.5 ? 1 : -1);
}

function endGame() {
    document.getElementById("gameover").style.display = "block";
    document.getElementById("gameover").textContent = 
        scoreLeft >= maxScore ? "Ganó Jugador Izquierdo" : "Ganó Jugador Derecho";
    ballSpeedX = 0;
    ballSpeedY = 0;
}

function update() {
    moveBall();
}

function game() {
    update();
    draw();
}

setInterval(game, 1000 / 60);

// Control táctil para ambos lados
canvas.addEventListener("touchmove", function(e) {
    for (let touch of e.touches) {
        let touchX = touch.clientX;
        let touchY = touch.clientY;

        if (touchX < canvas.width / 2) {
            leftPaddleY = touchY - paddleHeight / 2;
        } else {
            rightPaddleY = touchY - paddleHeight / 2;
        }
    }
});
</script>
</body>
</html>
